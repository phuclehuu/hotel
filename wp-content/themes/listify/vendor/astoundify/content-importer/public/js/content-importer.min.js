!function(t,e){var n=t(window),o=o||{};o.importRunning=!1,o.$div=t("#astoundify-ci"),o.beforeUnload=function(){if(o.importRunning)return"Please do not leave while an import is in progress."},o.stageImport=function(e){_.each(e,function(e,n){var r=e.length;0===r?t("#import-type-"+n).hide():(o.typeElement(n,"spinner").addClass("is-active"),o.typeElement(n,"processed").text(0),o.typeElement(n,"total").text(r))})},o.runIterateImport=function(e,n){t("#import-status").html(""),t("#import-errors").html(""),o.importRunning=!0;var r=t.Deferred().resolve(),i=[];_.each(e,function(t,e){"object"!==e?i.push(t):_.each(t,function(t){i.push([t])})}),i=_.reject(i,function(t){return 0===t.length}),_.each(i,function(t){r=r.then(function(){return o.runImport(t,n)})})},o.runImport=function(e,n){return t.ajax({type:"POST",url:ajaxurl,data:{action:"astoundify_ci_iterate_item",iterate_action:n,items:e},dataType:"json",success:function(e){!1!==e.success&&_.each(e,function(e,n){var r=e.item.type,i=parseInt(o.typeElement(r,"total").text()),a=parseInt(o.typeElement(r,"processed").text());if(o.typeElement(r,"processed").text(a+1),a=parseInt(o.typeElement(r,"processed").text()),!1===e.success&&t("#import-errors").show().prepend("<li>"+e.data+"</li>"),a===i){o.typeElement(r,"spinner").removeClass("is-active");var s=!0;t(".import-type").each(function(e,n){parseInt(t(this).find(".processed-count").text())!==parseInt(t(this).find(".total-count").text())&&(s=!1)}),!0===s&&(o.importRunning=!1)}})},error:function(t,e,n){window.console&&console.log(e+": "+n)}})},o.typeElement=function(e,n){return t("#"+e+"-"+n)},n.bind("beforeunload",o.beforeUnload),jQuery(document).ready(function(t){o.$div.find("a.button-import").on("click",function(e){e.preventDefault();var n=t(this);return t.ajax({type:"POST",url:ajaxurl,data:{action:"astoundify_ci",security:astoundifyContentImporter.nonces.stage,page:astoundifyContentImporter.page,files:astoundifyContentImporterFiles,pack:t("input[name=astoundify_ci_pack]").val()},dataType:"json",success:function(e){e.success?(t("#plugins-to-import").hide(),t("#import-summary").slideDown("slow"),groups=e.data.groups,items=e.data.items,o.stageImport(groups),o.runIterateImport(groups,n.data("action"))):(t("#plugins-to-import").hide(),t("#import-errors").show().html("<li>"+e.data+"</li>"))}})})})}(jQuery,window.wp);
//# sourceMappingURL=content-importer.min.js.map
